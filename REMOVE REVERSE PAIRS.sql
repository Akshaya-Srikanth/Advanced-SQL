-- REMOVE REVERSE PAIRS

DROP TABLE IF EXISTS #TEMPPAIRS

CREATE TABLE #TEMPPAIRS
( A INT,
B INT
)

INSERT INTO #TEMPPAIRS
SELECT 1,2
UNION
SELECT 3,2
UNION
SELECT 2,4
UNION
SELECT 2,1
UNION
SELECT 5,6
UNION
SELECT 4,2

SELECT * FROM #TEMPPAIRS

/*
Expected O/P

A B
1 2
3 2
2 4
5 6
*/

-- APPROACH 1: USING JOIN

SELECT T1.A,T1.B
FROM #TEMPPAIRS T1
LEFT JOIN  #TEMPPAIRS T2
ON T1.A=T2.B AND T1.B=T2.A
WHERE  T2.A IS NULL OR T1.A<T2.A 

-- APPROACH 2: USING NOT EXISTS

SELECT T1.A,T1.B
FROM #TEMPPAIRS T1
WHERE NOT EXISTS ( SELECT 1 
FROM #TEMPPAIRS T2 WHERE T1.A=T2.B AND T1.B =T2.A AND T1.A>T2.A)

-- APPROACH 3: USING ROW NUM

select A, B
FROM
(
SELECT A,B, ROW_NUMBER() OVER( PARTITION BY  A+B  ORDER BY A) AS RN
FROM #TEMPPAIRS
) AS T
WHERE T.RN=1







